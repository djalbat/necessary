"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.get = get;
exports.post = post;
exports.request = request;
exports.default = void 0;
var _constants = require("../constants");
var _methods = require("../methods");
var _contentTypes = require("../contentTypes");
var _http = require("../utilities/http");
function get(host, uri, parameters, headers, callback) {
    if (callback === undefined) {
        callback = headers; ///
        headers = {
        };
    }
    var method = _methods.GET_METHOD, body = null;
    underwriteAccept(headers);
    request(host, uri, parameters, method, body, headers, callback);
}
function post(host, uri, parameters, body, headers, callback) {
    if (callback === undefined) {
        callback = headers; ///
        headers = {
        };
    }
    var method = _methods.POST_METHOD;
    underwriteAccept(headers);
    underwriteContentType(headers);
    request(host, uri, parameters, method, body, headers, callback);
}
function request(host, uri, parameters, method, body, headers, callback) {
    var url = (0, _http).urlFromHostURIAndParameters(host, uri, parameters), accept = headers[_constants.ACCEPT] || null, contentType = headers[_constants.CONTENT_TYPE] || null, xmlHttpRequest = new XMLHttpRequest();
    if (contentType === _contentTypes.APPLICATION_JSON_CONTENT_TYPE) {
        var json = body, jsonString = JSON.stringify(json);
        body = jsonString; ///
    }
    xmlHttpRequest.onreadystatechange = function() {
        var readyState = xmlHttpRequest.readyState, status = xmlHttpRequest.status, responseText = xmlHttpRequest.responseText;
        if (readyState == 4) {
            var body = responseText;
            if (accept === _contentTypes.APPLICATION_JSON_CONTENT_TYPE) {
                try {
                    var jsonString = body, json = JSON.parse(jsonString);
                    body = json; ///
                } catch (error) {
                    body = null;
                }
                callback(body, status);
            }
        }
    };
    xmlHttpRequest.open(method, url);
    if (accept !== null) {
        xmlHttpRequest.setRequestHeader(_constants.ACCEPT, accept);
    }
    if (contentType !== null) {
        xmlHttpRequest.setRequestHeader(_constants.CONTENT_TYPE, contentType);
    }
    body !== null ? xmlHttpRequest.send(body) : xmlHttpRequest.send();
}
var _default = {
    get: get,
    post: post,
    request: request
};
exports.default = _default;
function underwriteAccept(headers) {
    var name = _constants.ACCEPT, value = _contentTypes.APPLICATION_JSON_CONTENT_TYPE; ///
    (0, _http).underwrite(headers, name, value);
}
function underwriteContentType(headers) {
    var name = _constants.CONTENT_TYPE, value = _contentTypes.APPLICATION_JSON_CONTENT_TYPE; ///
    (0, _http).underwrite(headers, name, value);
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXRpZXMvYWpheC5qcyJdLCJuYW1lcyI6WyJBQ0NFUFQiLCJDT05URU5UX1RZUEUiLCJHRVRfTUVUSE9EIiwiUE9TVF9NRVRIT0QiLCJBUFBMSUNBVElPTl9KU09OX0NPTlRFTlRfVFlQRSIsInVuZGVyd3JpdGUiLCJ1cmxGcm9tSG9zdFVSSUFuZFBhcmFtZXRlcnMiLCJnZXQiLCJob3N0IiwidXJpIiwicGFyYW1ldGVycyIsImhlYWRlcnMiLCJjYWxsYmFjayIsInVuZGVmaW5lZCIsIm1ldGhvZCIsImJvZHkiLCJ1bmRlcndyaXRlQWNjZXB0IiwicmVxdWVzdCIsInBvc3QiLCJ1bmRlcndyaXRlQ29udGVudFR5cGUiLCJ1cmwiLCJhY2NlcHQiLCJjb250ZW50VHlwZSIsInhtbEh0dHBSZXF1ZXN0IiwiWE1MSHR0cFJlcXVlc3QiLCJqc29uIiwianNvblN0cmluZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwicmVzcG9uc2VUZXh0IiwicGFyc2UiLCJlcnJvciIsIm9wZW4iLCJzZXRSZXF1ZXN0SGVhZGVyIiwic2VuZCIsIm5hbWUiLCJ2YWx1ZSJdLCJtYXBwaW5ncyI6IkNBQUEsVUFBWTs7OztRQU9JLEdBQUcsR0FBSCxHQUFHO1FBY0gsSUFBSSxHQUFKLElBQUk7UUFlSixPQUFPLEdBQVAsT0FBTzs7QUFsQ2MsR0FBYyxDQUFkLFVBQWM7QUFDWCxHQUFZLENBQVosUUFBWTtBQUNOLEdBQWlCLENBQWpCLGFBQWlCO0FBQ1AsR0FBbUIsQ0FBbkIsS0FBbUI7U0FFM0QsR0FBRyxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsQ0FBQztJQUM3RCxFQUFFLEVBQUUsUUFBUSxLQUFLLFNBQVMsRUFBRSxDQUFDO1FBQzNCLFFBQVEsR0FBRyxPQUFPLENBQUUsQ0FBRyxBQUFILEVBQUcsQUFBSCxDQUFHO1FBQ3ZCLE9B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