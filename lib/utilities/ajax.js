"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get default () {
        return _default;
    },
    get get () {
        return get;
    },
    get post () {
        return post;
    },
    get request () {
        return request;
    }
});
const _constants = require("../constants");
const _methods = require("../methods");
const _contentTypes = require("../contentTypes");
const _headers = require("../headers");
const _http = require("../utilities/http");
function get(host, uri, query, headers, responseType, callback) {
    if (typeof headers === _constants.FUNCTION) {
        callback = headers; ///
        responseType = null;
        headers = {};
    }
    if (typeof responseType === _constants.FUNCTION) {
        callback = responseType; ///
        if (typeof headers === _constants.STRING) {
            responseType = headers; ///
            headers = {};
        } else {
            responseType = null;
        }
    }
    const method = _methods.GET_METHOD, accept = _contentTypes.APPLICATION_JSON_CONTENT_TYPE, content = null;
    underwriteAcceptHeader(headers, accept);
    request(host, uri, query, method, content, headers, responseType, callback);
}
function post(host, uri, query, content, headers, responseType, callback) {
    if (typeof headers === _constants.FUNCTION) {
        callback = headers; ///
        responseType = null;
        headers = {};
    }
    if (typeof responseType === _constants.FUNCTION) {
        callback = responseType; ///
        if (typeof headers === _constants.STRING) {
            responseType = headers; ///
            headers = {};
        } else {
            responseType = null;
        }
    }
    const method = _methods.POST_METHOD, accept = _contentTypes.APPLICATION_JSON_CONTENT_TYPE, contentType = _contentTypes.APPLICATION_JSON_CONTENT_TYPE;
    underwriteAcceptHeader(headers, accept);
    underwriteContentTypeHeader(headers, contentType);
    request(host, uri, query, method, content, headers, responseType, callback);
}
function request(host, uri, query, method, content, headers, responseType, callback) {
    const url = (0, _http.urlFromHostURIAndQuery)(host, uri, query), accept = headers[_headers.ACCEPT_HEADER] || null, contentType = headers[_headers.CONTENT_TYPE_HEADER] || null, xmlHttpRequest = new XMLHttpRequest();
    if (contentType === _contentTypes.APPLICATION_JSON_CONTENT_TYPE) {
        const json = content, jsonString = JSON.stringify(json);
        content = jsonString; ///
    }
    if (responseType !== null) {
        Object.assign(xmlHttpRequest, {
            responseType
        });
    }
    xmlHttpRequest.onreadystatechange = ()=>{
        const { readyState, status, response } = xmlHttpRequest, statusCode = status;
        if (readyState == 4) {
            let content = response;
            if (accept === _contentTypes.APPLICATION_JSON_CONTENT_TYPE) {
                try {
                    const jsonString = content, json = JSON.parse(jsonString);
                    content = json; ///
                } catch (error) {
                    content = null;
                }
            }
            callback(content, statusCode);
        }
    };
    xmlHttpRequest.open(method, url);
    if (accept !== null) {
        xmlHttpRequest.setRequestHeader(_headers.ACCEPT_HEADER, accept);
    }
    if (contentType !== null) {
        xmlHttpRequest.setRequestHeader(_headers.CONTENT_TYPE_HEADER, contentType);
    }
    content !== null ? xmlHttpRequest.send(content) : xmlHttpRequest.send();
}
const _default = {
    get,
    post,
    request
};
function underwriteAcceptHeader(headers, accept) {
    const name = _headers.ACCEPT_HEADER, value = accept; ///
    (0, _http.underwrite)(headers, name, value);
}
function underwriteContentTypeHeader(headers, contentTYpe) {
    const name = _headers.CONTENT_TYPE_HEADER, value = contentTYpe; ///
    (0, _http.underwrite)(headers, name, value);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXRpZXMvYWpheC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IHsgU1RSSU5HLCBGVU5DVElPTiB9IGZyb20gXCIuLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IEdFVF9NRVRIT0QsIFBPU1RfTUVUSE9EIH0gZnJvbSBcIi4uL21ldGhvZHNcIjtcbmltcG9ydCB7IEFQUExJQ0FUSU9OX0pTT05fQ09OVEVOVF9UWVBFIH0gZnJvbSBcIi4uL2NvbnRlbnRUeXBlc1wiO1xuaW1wb3J0IHsgQUNDRVBUX0hFQURFUiwgQ09OVEVOVF9UWVBFX0hFQURFUiB9IGZyb20gXCIuLi9oZWFkZXJzXCI7XG5pbXBvcnQgeyB1bmRlcndyaXRlLCB1cmxGcm9tSG9zdFVSSUFuZFF1ZXJ5IH0gZnJvbSBcIi4uL3V0aWxpdGllcy9odHRwXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXQoaG9zdCwgdXJpLCBxdWVyeSwgaGVhZGVycywgcmVzcG9uc2VUeXBlLCBjYWxsYmFjaykge1xuICBpZiAodHlwZW9mIGhlYWRlcnMgPT09IEZVTkNUSU9OKSB7XG4gICAgY2FsbGJhY2sgPSBoZWFkZXJzOyAvLy9cblxuICAgIHJlc3BvbnNlVHlwZSA9IG51bGw7XG5cbiAgICBoZWFkZXJzID0ge307XG4gIH1cblxuICBpZiAodHlwZW9mIHJlc3BvbnNlVHlwZSA9PT0gRlVOQ1RJT04pIHtcbiAgICBjYWxsYmFjayA9IHJlc3BvbnNlVHlwZTsgIC8vL1xuXG4gICAgaWYgKHR5cGVvZiBoZWFkZXJzID09PSBTVFJJTkcpIHtcbiAgICAgIHJlc3BvbnNlVHlwZSA9IGhlYWRlcnM7IC8vL1xuXG4gICAgICBoZWFkZXJzID0ge307XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3BvbnNlVHlwZSA9IG51bGxcbiAgICB9XG4gIH1cblxuICBjb25zdCBtZXRob2QgPSBHRVRfTUVUSE9ELFxuICAgICAgICBhY2NlcHQgPSBBUFBMSUNBVElPTl9KU09OX0NPTlRFTlRfVFlQRSxcbiAgICAgICAgY29udGVudCA9IG51bGw7XG5cbiAgdW5kZXJ3cml0ZUFjY2VwdEhlYWRlcihoZWFkZXJzLCBhY2NlcHQpO1xuXG4gIHJlcXVlc3QoaG9zdCwgdXJpLCBxdWVyeSwgbWV0aG9kLCBjb250ZW50LCBoZWFkZXJzLCByZXNwb25zZVR5cGUsIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvc3QoaG9zdCwgdXJpLCBxdWVyeSwgY29udGVudCwgaGVhZGVycywgcmVzcG9uc2VUeXBlLCBjYWxsYmFjaykge1xuICBpZiAodHlwZW9mIGhlYWRlcnMgPT09IEZVTkNUSU9OKSB7XG4gICAgY2FsbGJhY2sgPSBoZWFkZXJzOyAvLy9cblxuICAgIHJlc3BvbnNlVHlwZSA9IG51bGw7XG5cbiAgICBoZWFkZXJzID0ge307XG4gIH1cblxuICBpZiAodHlwZW9mIHJlc3BvbnNlVHlwZSA9PT0gRlVOQ1RJT04pIHtcbiAgICBjYWxsYmFjayA9IHJlc3BvbnNlVHlwZTsgIC8vL1xuXG4gICAgaWYgKHR5cGVvZiBoZWFkZXJzID09PSBTVFJJTkcpIHtcbiAgICAgIHJlc3BvbnNlVHlwZSA9IGhlYWRlcnM7IC8vL1xuXG4gICAgICBoZWFkZXJzID0ge307XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3BvbnNlVHlwZSA9IG51bGxcbiAgICB9XG4gIH1cblxuICBjb25zdCBtZXRob2QgPSBQT1NUX01FVEhPRCxcbiAgICAgICAgYWNjZXB0ID0gQVBQTElDQVRJT05fSlNPTl9DT05URU5UX1RZUEUsXG4gICAgICAgIGNvbnRlbnRUeXBlID0gQVBQTElDQVRJT05fSlNPTl9DT05URU5UX1RZUEU7XG5cbiAgdW5kZXJ3cml0ZUFjY2VwdEhlYWRlcihoZWFkZXJzLCBhY2NlcHQpO1xuXG4gIHVuZGVyd3JpdGVDb250ZW50VHlwZUhlYWRlcihoZWFkZXJzLCBjb250ZW50VHlwZSk7XG5cbiAgcmVxdWVzdChob3N0LCB1cmksIHF1ZXJ5LCBtZXRob2QsIGNvbnRlbnQsIGhlYWRlcnMsIHJlc3BvbnNlVHlwZSwgY2FsbGJhY2spO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVxdWVzdChob3N0LCB1cmksIHF1ZXJ5LCBtZXRob2QsIGNvbnRlbnQsIGhlYWRlcnMsIHJlc3BvbnNlVHlwZSwgY2FsbGJhY2spIHtcbiAgY29uc3QgdXJsID0gdXJsRnJvbUhvc3RVUklBbmRRdWVyeShob3N0LCB1cmksIHF1ZXJ5KSxcbiAgICAgICAgYWNjZXB0ID0gaGVhZGVyc1tBQ0NFUFRfSEVBREVSXSB8fCBudWxsLFxuICAgICAgICBjb250ZW50VHlwZSA9IGhlYWRlcnNbQ09OVEVOVF9UWVBFX0hFQURFUl0gfHwgbnVsbCxcbiAgICAgICAgeG1sSHR0cFJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICBpZiAoY29udGVudFR5cGUgPT09IEFQUExJQ0FUSU9OX0pTT05fQ09OVEVOVF9UWVBFKSB7XG4gICAgY29uc3QganNvbiA9IGNvbnRlbnQsICAvLy9cbiAgICAgICAgICBqc29uU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoanNvbik7XG5cbiAgICBjb250ZW50ID0ganNvblN0cmluZzsgIC8vL1xuICB9XG5cbiAgaWYgKHJlc3BvbnNlVHlwZSAhPT0gbnVsbCkge1xuICAgIE9iamVjdC5hc3NpZ24oeG1sSHR0cFJlcXVlc3QsIHtcbiAgICAgIHJlc3BvbnNlVHlwZVxuICAgIH0pO1xuICB9XG5cbiAgeG1sSHR0cFJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVhZHlTdGF0ZSwgc3RhdHVzLCByZXNwb25zZSB9ID0geG1sSHR0cFJlcXVlc3QsXG4gICAgICAgICAgc3RhdHVzQ29kZSA9IHN0YXR1cztcblxuICAgIGlmIChyZWFkeVN0YXRlID09IDQpIHtcbiAgICAgIGxldCBjb250ZW50ID0gcmVzcG9uc2U7XG5cbiAgICAgIGlmIChhY2NlcHQgPT09IEFQUExJQ0FUSU9OX0pTT05fQ09OVEVOVF9UWVBFKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QganNvblN0cmluZyA9IGNvbnRlbnQsICAvLy9cbiAgICAgICAgICAgICAgICBqc29uID0gSlNPTi5wYXJzZShqc29uU3RyaW5nKTtcblxuICAgICAgICAgIGNvbnRlbnQgPSBqc29uOyAgLy8vXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29udGVudCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY2FsbGJhY2soY29udGVudCwgc3RhdHVzQ29kZSk7XG4gICAgfVxuICB9O1xuXG4gIHhtbEh0dHBSZXF1ZXN0Lm9wZW4obWV0aG9kLCB1cmwpO1xuXG4gIGlmIChhY2NlcHQgIT09IG51bGwpIHtcbiAgICB4bWxIdHRwUmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKEFDQ0VQVF9IRUFERVIsIGFjY2VwdCk7XG4gIH1cblxuICBpZiAoY29udGVudFR5cGUgIT09IG51bGwpIHtcbiAgICB4bWxIdHRwUmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKENPTlRFTlRfVFlQRV9IRUFERVIsIGNvbnRlbnRUeXBlKTtcbiAgfVxuXG4gIChjb250ZW50ICE9PSBudWxsKSA/XG4gICAgeG1sSHR0cFJlcXVlc3Quc2VuZChjb250ZW50KSA6XG4gICAgICB4bWxIdHRwUmVxdWVzdC5zZW5kKCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgZ2V0LFxuICBwb3N0LFxuICByZXF1ZXN0XG59XG5cbmZ1bmN0aW9uIHVuZGVyd3JpdGVBY2NlcHRIZWFkZXIoaGVhZGVycywgYWNjZXB0KSB7XG4gIGNvbnN0IG5hbWUgPSBBQ0NFUFRfSEVBREVSLCAgLy8vXG4gICAgICAgIHZhbHVlID0gYWNjZXB0OyAvLy9cblxuICB1bmRlcndyaXRlKGhlYWRlcnMsIG5hbWUsIHZhbHVlKTtcbn1cblxuZnVuY3Rpb24gdW5kZXJ3cml0ZUNvbnRlbnRUeXBlSGVhZGVyKGhlYWRlcnMsIGNvbnRlbnRUWXBlKSB7XG4gIGNvbnN0IG5hbWUgPSBDT05URU5UX1RZUEVfSEVBREVSLCAgLy8vXG4gICAgICAgIHZhbHVlID0gY29udGVudFRZcGU7IC8vL1xuXG4gIHVuZGVyd3JpdGUoaGVhZGVycywgbmFtZSwgdmFsdWUpO1xufVxuIl0sIm5hbWVzIjpbImdldCIsInBvc3QiLCJyZXF1ZXN0IiwiaG9zdCIsInVyaSIsInF1ZXJ5IiwiaGVhZGVycyIsInJlc3BvbnNlVHlwZSIsImNhbGxiYWNrIiwiRlVOQ1RJT04iLCJTVFJJTkciLCJtZXRob2QiLCJHRVRfTUVUSE9EIiwiYWNjZXB0IiwiQVBQTElDQVRJT05fSlNPTl9DT05URU5UX1RZUEUiLCJjb250ZW50IiwidW5kZXJ3cml0ZUFjY2VwdEhlYWRlciIsIlBPU1RfTUVUSE9EIiwiY29udGVudFR5cGUiLCJ1bmRlcndyaXRlQ29udGVudFR5cGVIZWFkZXIiLCJ1cmwiLCJ1cmxGcm9tSG9zdFVSSUFuZFF1ZXJ5IiwiQUNDRVBUX0hFQURFUiIsIkNPTlRFTlRfVFlQRV9IRUFERVIiLCJ4bWxIdHRwUmVxdWVzdCIsIlhNTEh0dHBSZXF1ZXN0IiwianNvbiIsImpzb25TdHJpbmciLCJKU09OIiwic3RyaW5naWZ5IiwiT2JqZWN0IiwiYXNzaWduIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlc3BvbnNlIiwic3RhdHVzQ29kZSIsInBhcnNlIiwiZXJyb3IiLCJvcGVuIiwic2V0UmVxdWVzdEhlYWRlciIsInNlbmQiLCJuYW1lIiwidmFsdWUiLCJ1bmRlcndyaXRlIiwiY29udGVudFRZcGUiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7OztRQThIQTtlQUFBOztRQXRIZ0JBO2VBQUFBOztRQThCQUM7ZUFBQUE7O1FBZ0NBQztlQUFBQTs7OzJCQXBFaUI7eUJBQ087OEJBQ007eUJBQ0s7c0JBQ0E7QUFFNUMsU0FBU0YsSUFBSUcsSUFBSSxFQUFFQyxHQUFHLEVBQUVDLEtBQUssRUFBRUMsT0FBTyxFQUFFQyxZQUFZLEVBQUVDLFFBQVE7SUFDbkUsSUFBSSxPQUFPRixZQUFZRyxtQkFB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