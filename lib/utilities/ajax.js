"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.get = get;
exports.post = post;
exports.request = request;
exports.default = void 0;
var _methods = require("../methods");
var _contentTypes = require("../contentTypes");
var _http = require("../utilities/http");
var _constants = require("../constants");
function get(host, uri, query, headers, callback) {
    if (callback === undefined) {
        callback = headers; ///
        headers = {
        };
    }
    var body = null, method = _methods.GET_METHOD, accept = _contentTypes.APPLICATION_JSON_CONTENT_TYPE;
    underwriteAccept(headers, accept);
    request(host, uri, query, method, headers, body, callback);
}
function post(host, uri, query, headers, body, callback) {
    if (callback === undefined) {
        callback = body;
        body = headers;
        headers = {
        };
    }
    var method = _methods.POST_METHOD, accept = _contentTypes.APPLICATION_JSON_CONTENT_TYPE, contentType = _contentTypes.APPLICATION_JSON_CONTENT_TYPE;
    underwriteAccept(headers, accept);
    underwriteContentType(headers, contentType);
    request(host, uri, query, method, headers, body, callback);
}
function request(host, uri, query, method, headers, body1, callback) {
    var url = (0, _http).urlFromHostURIAndQuery(host, uri, query), accept = headers[_constants.ACCEPT] || null, contentType = headers[_constants.CONTENT_TYPE] || null, xmlHttpRequest = new XMLHttpRequest();
    if (contentType === _contentTypes.APPLICATION_JSON_CONTENT_TYPE) {
        var json = body1, jsonString = JSON.stringify(json), content = jsonString, contentLength = content.length;
        underwriteContentLength(headers, contentLength);
        body1 = jsonString; ///
    }
    xmlHttpRequest.onreadystatechange = function() {
        var readyState = xmlHttpRequest.readyState, status = xmlHttpRequest.status, responseText = xmlHttpRequest.responseText;
        if (readyState == 4) {
            var body = responseText;
            if (accept === _contentTypes.APPLICATION_JSON_CONTENT_TYPE) {
                try {
                    var jsonString = body, json = JSON.parse(jsonString);
                    body = json; ///
                } catch (error) {
                    body = null;
                }
                callback(body, status);
            }
        }
    };
    xmlHttpRequest.open(method, url);
    if (accept !== null) {
        xmlHttpRequest.setRequestHeader(_constants.ACCEPT, accept);
    }
    if (contentType !== null) {
        xmlHttpRequest.setRequestHeader(_constants.CONTENT_TYPE, contentType);
    }
    body1 !== null ? xmlHttpRequest.send(body1) : xmlHttpRequest.send();
}
var _default = {
    get: get,
    post: post,
    request: request
};
exports.default = _default;
function underwriteAccept(headers, accept) {
    var name = _constants.ACCEPT, value = accept; ///
    (0, _http).underwrite(headers, name, value);
}
function underwriteContentType(headers, contentTYpe) {
    var name = _constants.CONTENT_TYPE, value = contentTYpe; ///
    (0, _http).underwrite(headers, name, value);
}
function underwriteContentLength(headers, contentLength) {
    var name = _constants.CONTENT_LENGTH, value = contentLength; ///
    (0, _http).underwrite(headers, name, value);
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXRpZXMvYWpheC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IHsgR0VUX01FVEhPRCwgUE9TVF9NRVRIT0QgfSBmcm9tIFwiLi4vbWV0aG9kc1wiO1xuaW1wb3J0IHsgQVBQTElDQVRJT05fSlNPTl9DT05URU5UX1RZUEUgfSBmcm9tIFwiLi4vY29udGVudFR5cGVzXCI7XG5pbXBvcnQgeyB1bmRlcndyaXRlLCB1cmxGcm9tSG9zdFVSSUFuZFF1ZXJ5IH0gZnJvbSBcIi4uL3V0aWxpdGllcy9odHRwXCI7XG5pbXBvcnQgeyBBQ0NFUFQsIENPTlRFTlRfVFlQRSwgQ09OVEVOVF9MRU5HVEggfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXQoaG9zdCwgdXJpLCBxdWVyeSwgaGVhZGVycywgY2FsbGJhY2spIHtcbiAgaWYgKGNhbGxiYWNrID09PSB1bmRlZmluZWQpIHtcbiAgICBjYWxsYmFjayA9IGhlYWRlcnM7IC8vL1xuICAgIGhlYWRlcnMgPSB7fTtcbiAgfVxuXG4gIGNvbnN0IGJvZHkgPSBudWxsLFxuICAgICAgICBtZXRob2QgPSBHRVRfTUVUSE9ELFxuICAgICAgICBhY2NlcHQgPSBBUFBMSUNBVElPTl9KU09OX0NPTlRFTlRfVFlQRTtcblxuICB1bmRlcndyaXRlQWNjZXB0KGhlYWRlcnMsIGFjY2VwdCk7XG5cbiAgcmVxdWVzdChob3N0LCB1cmksIHF1ZXJ5LCBtZXRob2QsIGhlYWRlcnMsIGJvZHksIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvc3QoaG9zdCwgdXJpLCBxdWVyeSwgaGVhZGVycywgYm9keSwgY2FsbGJhY2spIHtcbiAgaWYgKGNhbGxiYWNrID09PSB1bmRlZmluZWQpIHtcbiAgICBjYWxsYmFjayA9IGJvZHk7XG4gICAgYm9keSA9IGhlYWRlcnM7XG4gICAgaGVhZGVycyA9IHt9O1xuICB9XG5cbiAgY29uc3QgbWV0aG9kID0gUE9TVF9NRVRIT0QsXG4gICAgICAgIGFjY2VwdCA9IEFQUExJQ0FUSU9OX0pTT05fQ09OVEVOVF9UWVBFLFxuICAgICAgICBjb250ZW50VHlwZSA9IEFQUExJQ0FUSU9OX0pTT05fQ09OVEVOVF9UWVBFO1xuXG4gIHVuZGVyd3JpdGVBY2NlcHQoaGVhZGVycywgYWNjZXB0KTtcblxuICB1bmRlcndyaXRlQ29udGVudFR5cGUoaGVhZGVycywgY29udGVudFR5cGUpO1xuXG4gIHJlcXVlc3QoaG9zdCwgdXJpLCBxdWVyeSwgbWV0aG9kLCBoZWFkZXJzLCBib2R5LCBjYWxsYmFjayk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXF1ZXN0KGhvc3QsIHVyaSwgcXVlcnksIG1ldGhvZCwgaGVhZGVycywgYm9keSwgY2FsbGJhY2spIHtcbiAgY29uc3QgdXJsID0gdXJsRnJvbUhvc3RVUklBbmRRdWVyeShob3N0LCB1cmksIHF1ZXJ5KSxcbiAgICAgICAgYWNjZXB0ID0gaGVhZGVyc1tBQ0NFUFRdIHx8IG51bGwsXG4gICAgICAgIGNvbnRlbnRUeXBlID0gaGVhZGVyc1tDT05URU5UX1RZUEVdIHx8IG51bGwsXG4gICAgICAgIHhtbEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgaWYgKGNvbnRlbnRUeXBlID09PSBBUFBMSUNBVElPTl9KU09OX0NPTlRFTlRfVFlQRSkge1xuICAgIGNvbnN0IGpzb24gPSBib2R5LCAgLy8vXG4gICAgICAgICAganNvblN0cmluZyA9IEpTT04uc3RyaW5naWZ5KGpzb24pLFxuICAgICAgICAgIGNvbnRlbnQgPSBqc29uU3RyaW5nLCAvLy9cbiAgICAgICAgICBjb250ZW50TGVuZ3RoID0gY29udGVudC5sZW5ndGg7XG5cbiAgICB1bmRlcndyaXRlQ29udGVudExlbmd0aChoZWFkZXJzLCBjb250ZW50TGVuZ3RoKTtcblxuICAgIGJvZHkgPSBqc29uU3RyaW5nOyAgLy8vXG4gIH1cblxuICB4bWxIdHRwUmVxdWVzdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgY29uc3QgeyByZWFkeVN0YXRlLCBzdGF0dXMsIHJlc3BvbnNlVGV4dCB9ID0geG1sSHR0cFJlcXVlc3Q7XG5cbiAgICBpZiAocmVhZHlTdGF0ZSA9PSA0KSB7XG4gICAgICBsZXQgYm9keSA9IHJlc3BvbnNlVGV4dDtcblxuICAgICAgaWYgKGFjY2VwdCA9PT0gQVBQTElDQVRJT05fSlNPTl9DT05URU5UX1RZUEUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBqc29uU3RyaW5nID0gYm9keSwgIC8vL1xuICAgICAgICAgICAgICAgIGpzb24gPSBKU09OLnBhcnNlKGpzb25TdHJpbmcpO1xuXG4gICAgICAgICAgYm9keSA9IGpzb247ICAvLy9cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBib2R5ID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNhbGxiYWNrKGJvZHksIHN0YXR1cyk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHhtbEh0dHBSZXF1ZXN0Lm9wZW4obWV0aG9kLCB1cmwpO1xuXG4gIGlmIChhY2NlcHQgIT09IG51bGwpIHtcbiAgICB4bWxIdHRwUmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKEFDQ0VQVCwgYWNjZXB0KTtcbiAgfVxuXG4gIGlmIChjb250ZW50VHlwZSAhPT0gbnVsbCkge1xuICAgIHhtbEh0dHBSZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoQ09OVEVOVF9UWVBFLCBjb250ZW50VHlwZSk7XG4gIH1cblxuICAoYm9keSAhPT0gbnVsbCkgP1xuICAgIHhtbEh0dHBSZXF1ZXN0LnNlbmQoYm9keSkgOlxuICAgICAgeG1sSHR0cFJlcXVlc3Quc2VuZCgpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIGdldCxcbiAgcG9zdCxcbiAgcmVxdWVzdFxufVxuXG5mdW5jdGlvbiB1bmRlcndyaXRlQWNjZXB0KGhlYWRlcnMsIGFjY2VwdCkge1xuICBjb25zdCBuYW1lID0gQUNDRVBULCAgLy8vXG4gICAgICAgIHZhbHVlID0gYWNjZXB0OyAvLy9cblxuICB1bmRlcndyaXRlKGhlYWRlcnMsIG5hbWUsIHZhbHVlKTtcbn1cblxuZnVuY3Rpb24gdW5kZXJ3cml0ZUNvbnRlbnRUeXBlKGhlYWRlcnMsIGNvbnRlbnRUWXBlKSB7XG4gIGNvbnN0IG5hbWUgPSBDT05URU5UX1RZUEUsICAvLy9cbiAgICAgICAgdmFsdWUgPSBjb250ZW50VFlwZTsgLy8vXG5cbiAgdW5kZXJ3cml0ZShoZWFkZXJzLCBuYW1lLCB2YWx1ZSk7XG59XG5cbmZ1bmN0aW9uIHVuZGVyd3JpdGVDb250ZW50TGVuZ3RoKGhlYWRlcnMsIGNvbnRlbnRMZW5ndGgpIHtcbiAgY29uc3QgbmFtZSA9IENPTlRFTlRfTEVOR1RILCAgLy8vXG4gICAgICAgIHZhbHVlID0gY29udGVudExlbmd0aDsgLy8vXG5cbiAgdW5kZXJ3cml0ZShoZWFkZXJzLCBuYW1lLCB2YWx1ZSk7XG59XG4iXSwibmFtZXMiOlsiZ2V0IiwicG9zdCIsInJlcXVlc3QiLCJob3N0IiwidXJpIiwicXVlcnkiLCJoZWFkZXJzIiwiY2FsbGJhY2siLCJ1bmRlZmluZWQiLCJib2R5IiwibWV0aG9kIiwiYWNjZXB0IiwidW5kZXJ3cml0ZUFjY2VwdCIsImNvbnRlbnRUeXBlIiwidW5kZXJ3cml0ZUNvbnRlbnRUeXBlIiwidXJsIiwieG1sSHR0cFJlcXVlc3QiLCJYTUxIdHRwUmVxdWVzdCIsImpzb24iLCJqc29uU3RyaW5nIiwiSlNPTiIsInN0cmluZ2lmeSIsImNvbnRlbnQiLCJjb250ZW50TGVuZ3RoIiwibGVuZ3RoIiwidW5kZXJ3cml0ZUNvbnRlbnRMZW5ndGgiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwicmVzcG9uc2VUZXh0IiwicGFyc2UiLCJlcnJvciIsIm9wZW4iLCJzZXRSZXF1ZXN0SGVhZGVyIiwic2VuZCIsIm5hbWUiLCJ2YWx1ZSIsImNvbnRlbnRUWXBlIl0sIm1hcHBpbmdzIjoiQUFBQSxDQUFZOzs7O1FB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